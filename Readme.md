# dWallet Contract

This is the smart contract used by the [dWallet](https://peepsx.com/dwallet) app and the [dPay](https://github.com/peepsx/dpay-app) app. This contract is used to store a user's extended public key for Bitcoin, Ethereum, Litecoin and TRON accounts and the child addresses that derive from them, on the [ARISEN](https://arisen.network) network.

This data is used in a variety of ways by both apps. For example, dPay is able to generate account addresses on-demand for payments, using a user's extended public key. Every time dPay generates an address for a single payment, this address is stored on ARISEN alongside the ```btype``` (blockchain type) and a [PeepsID](https://peepsx.com/peepsid) (A user's account). Since dWallet uses this contract and its database to retrieve account addresses, the moment dPay generates an address for a payment, a user can access the account related to that address via dWallet almost instantly. Since dWallet securely manages the root private key that derived the extended public key, a user can manipulate these accounts (send funds, etc).

## Example Usage
1. A business uses the dPay WooCommerce (Wordpress) plugin for accepting crypto payments within their online store.
2. A new address is generated for each payment (Bob buys a TShirt, chooses to pay with Bitcoin and a new Bitcoin address is derived from the business's Bitcoin extended public key).
3. The new address is associated with the business' PeepsID and stored on ARISEN
4. Bob sends 0.1 BTC to the address to purchase his TShirt (expensive TShirt right - lol)
5. The business can now login to dWallet with their PeepsID, select Bitcoin and can manage all of the Bitcoin addresses generated by dPay, including the one Bob just sent money to. 

NOTE: The business doesn't have to manually add these addresses to dWallet, since dPay stores them in the database related to this contract and dWallet constantly performs lookups on that database.

## Usage
You can interact with this contract using [AriseCLI](https://arisen.network/arisecli).

### Adding Extended Public Key For A Blockchain Type
```
arisecli push action dwallet key '["jared", "bitcoin", "extended-public-key-here"]' -p jared@active
```

### Adding Address For A Blockchain Type
```
arisecli push action dwallet key '["jared", "bitcoin", "bitcoin-address"]' -p jared@active
```

## Contract Actions
This contract operates around the `key` and `add` actions. 

### `key` Action
The `key` action is used for adding an extended public key for a blockchain type.

#### `key` Parameters
- `peepsid` - This is the PeepsID of the dWallet user adding the extended public key.
- `btype` - This is the blockchain type of the extended public key (accepted types are bitcoin, ethereum, litecoin and tron). (string).
- `exkey` - The extended public key (string).

### `add` Action
The `add` action is used for adding an address of a particular blockchain type.

#### `add` Parameters
- `peepsid` - This is the PeepsID of the dWallet user adding the address.
- `btype` - This is the blockchain type of the address (string).
- `address` - This is the address (string).

## LICENSE
[MIT](LICENSE.md)

## Copyright
Copyright 2020 PeepsLabs. All rights reserved.
